!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).RevealAsciinemaFragment=t()}(this,(function(){"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function t(t,n){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=function(t,n){if(t){if("string"==typeof t)return e(t,n);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?e(t,n):void 0}}(t))||n&&t&&"number"==typeof t.length){a&&(t=a);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,l=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var e=a.next();return o=e.done,e},e:function(e){l=!0,s=e},f:function(){try{o||null==a.return||a.return()}finally{if(l)throw s}}}}return function(){var e,n,a,i=null;function r(e){var t=e.id,a=e.url,i=e.pauses||[],r=e.rows||n.rows,s=e.cols||n.cols,o=e.fontSize||n.fontSize,l=t+"-asciinema",c=t+"-asciinema-container",u=t+"-asciinema-fragment-container",d=document.querySelector("#"+u);if(d){var f=document.createElement("div");f.id=c,f.classList.add("fullpage"),f.style.display="none";var m=document.createElement("template"),p='<asciinema-player id="'+l+'" src="'+a+'" cols="'+s+'" rows="'+r+'" font-size="'+o+'"></asciinema-player>';m.innerHTML=p;var y=m.content.firstChild;f.appendChild(y),f.player=y,document.body.appendChild(f);var h=document.createElement("span");if(h.classList.add("fragment"),h.setAttribute("data-asciinema-show",l),h.container=f,d.appendChild(h),i.length>0){for(var v=0;v<i.length;v++){var g=document.createElement("span");g.classList.add("fragment"),g.setAttribute("data-asciinema-play",l),g.startTime=i[v],g.endTime=v+1==i.length?1/0:i[v+1],g.container=f,d.appendChild(g)}y.hasPauses=!0,y.addEventListener("timeupdate",(function(e){var t=this.currentTime,n=this.endTime;null!=n&&t>=n&&this.pause()}))}else y.hasPauses=!1;(h=document.createElement("span")).classList.add("fragment"),h.setAttribute("data-asciinema-hide",l),h.container=f,d.appendChild(h)}else console.log("element cannot found: ",u)}return{id:"asciinema-fragment",init:function(s){(function(e){(n=e.asciinema||{}).rows=n.rows||27,n.cols=n.cols||111,n.fontSize=n.fontSize||"12px",n.instances=n.instances||[]})((e=s).getConfig()),a=scriptPath("asciinema-fragment"),loadResource(a+"asciinema-fragment.css","stylesheet",(function(){})),loadResource(a+"asciinema-player.css","stylesheet",(function(){})),loadResource(a+"asciinema-player.js","script",(function(){var e,a=t(n.instances);try{for(a.s();!(e=a.n()).done;){r(e.value)}}catch(e){a.e(e)}finally{a.f()}})),e.on("fragmentshown",(function(e){var t=e.fragment;if(t.hasAttribute("data-asciinema-show")){var n=t.container;n.player,n.style.display="block",i=n;var a=n.offsetHeight,r=n.offsetWidth,s=window.innerWidth,o=window.innerHeight/a,l=s/r;n.style.transform="translate(-50%, -50%) scale("+Math.min(o,l)+")",n.style.inset="50% auto auto 50%"}else if(t.hasAttribute("data-asciinema-play")){var c=t.container.player;c.playing?t.classList.remove("visible"):(c.startTime=t.startTime,c.endTime=t.endTime,c.play())}else if(t.hasAttribute("data-asciinema-hide")){t.container.style.display="none",i=null}})),e.on("fragmenthidden",(function(e){var t=e.fragment;if(t.hasAttribute("data-asciinema-show")){var n=t.container,a=n.player;a.pause(),a.currentTime=0,n.style.display="none",i=null}else if(t.hasAttribute("data-asciinema-play")){var r=t.container.player;r.currentTime=t.startTime,r.pause()}else if(t.hasAttribute("data-asciinema-hide")){var s=t.container;s.style.display="block",i=s}})),e.on("slidechanged",(function(e){if(i){var t=i.player;t.pause(),t.currentTime=0,i.style.display="none"}}))}}}}));
